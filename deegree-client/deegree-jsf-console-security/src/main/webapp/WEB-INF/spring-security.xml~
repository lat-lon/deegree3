<!-- Spring Security Configuration for CSW 2.0.2 author <a href="mailto:erben@lat-lon.de">Alexander 
  Erben</a> author <a href="mailto:stenger@lat-lon.de">Dirk Stenger</a> -->

<beans:beans xmlns="http://www.springframework.org/schema/security"
  xmlns:beans="http://www.springframework.org/schema/beans" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
  xmlns:context="http://www.springframework.org/schema/context"
  xmlns:aop="http://www.springframework.org/schema/aop"
  xsi:schemaLocation="http://www.springframework.org/schema/beans
          http://www.springframework.org/schema/beans/spring-beans-3.0.xsd
          http://www.springframework.org/schema/security
          http://www.springframework.org/schema/security/spring-security-3.1.xsd
          http://www.springframework.org/schema/context
          http://www.springframework.org/schema/context/spring-context-3.0.xsd
          http://www.springframework.org/schema/aop http://www.springframework.org/schema/aop/spring-aop.xsd">

  <http auto-config="true">
    <http-basic />
    <custom-filter ref="ogcServiceFilter" after="LAST" />
  </http>

  <beans:bean id="getMethodGetRecordsFilter"
    class="org.deegree.console.security.HttpGetFilterImpl">
    <beans:constructor-arg type="java.lang.String"
      value="getrecords" />
    <beans:constructor-arg type="java.lang.String"
      value="ROLE_RECORDS" />
  </beans:bean>

  <beans:bean id="getMethodGetRecordByIdFilter"
    class="org.deegree.console.security.HttpGetFilterImpl">
    <beans:constructor-arg type="java.lang.String"
      value="getrecordbyid" />
    <beans:constructor-arg type="java.lang.String"
      value="ROLE_RECORDBYID" />
  </beans:bean>

  <beans:bean id="postXmlMethodGetRecordsFilter"
    class="org.deegree.console.security.HttpPostXmlFilterImpl">
    <beans:constructor-arg type="java.lang.String"
      value="getrecords" />
    <beans:constructor-arg type="java.lang.String"
      value="ROLE_RECORDS" />
  </beans:bean>

  <beans:bean id="postXmlMethodGetRecordByIdFilter"
    class="org.deegree.console.security.HttpPostXmlFilterImpl">
    <beans:constructor-arg type="java.lang.String"
      value="getrecordbyid" />
    <beans:constructor-arg type="java.lang.String"
      value="ROLE_RECORDBYID" />
  </beans:bean>

  <beans:bean id="ogcServiceFilter"
    class="org.deegree.console.security.OGCServiceFilter">
    <beans:constructor-arg index="0">
      <beans:list>
        <beans:ref bean="getMethodGetRecordsFilter" />
        <beans:ref bean="getMethodGetRecordByIdFilter" />
      </beans:list>
    </beans:constructor-arg>
    <beans:constructor-arg index="1">
      <beans:list>
        <beans:ref bean="postXmlMethodGetRecordsFilter" />
        <beans:ref bean="postXmlMethodGetRecordByIdFilter" />
      </beans:list>
    </beans:constructor-arg>
    <beans:property name="authenticationManager" ref="am"/>
  </beans:bean>

  <authentication-manager alias="am">
    <authentication-provider>
      <user-service>
        <user name="records" password="records" authorities="ROLE_RECORDS" />
        <user name="recordbyid" password="recordbyid" authorities="ROLE_RECORDBYID" />
        <user name="admin" password="admin" authorities="ROLE_ADMIN" />
      </user-service>
    </authentication-provider>
  </authentication-manager>

</beans:beans>
